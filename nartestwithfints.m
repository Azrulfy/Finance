symbols = {'#ADS.DE','#ALIBABA','#ALU.PA','#ALV.DE','#AMAZON','#AMERICAN_A','#AMERICAN_E','#APPLE','#ASML.AS','#AT&T','#BAIDU','#BAPO.MI','#BARC.L','#BATS.L','#BAYN.DE','#BBVA.MC','#BERKSHIRE','#BKIA.MC','#BNP.PA','#BOA','#BOEING','#BP.L','#CAC40`','#CAT','#CBK.DE','#CHEVRON','#CISCO','#CITIGROUP','#CNA50','#COCA-COLA','#CS.PA','#DAX30`','#DBK.DE','#DISNEY','#DJ30`','#DJ_EUR50`','#DOLLAR_IND','#DTE.DE','#ENG.MC','#EXXONMOBIL','#FACEBOOK','#FCA.MI','#FERRARI','#FIREEYE','#FTSE100`','#FTSEMIB40','#GAM.MC','#GE','#GM','#GOOGLE','#GPRO','#GROUPON','#GS','#GSK.L','#HP','#HSBA.L','#HSI','#IBEX35','#INTEL','#JNJ','#JP_MORGAN','#LHA.DE','#LINKEDIN','#MCDONALDS','#MICROSOFT','#MNDI.L','#MORGAN_STA','#NASDAQ100`','#NFLX','#NIKKEI225','#PAYPAL','#PFIZER','#PG','#PHIA.AS','#POTASH','#RDSA.L','#RUSS2000','#S&P500`','#SAB.L','#SAF.PA','#SAN.MC','#SAP.DE','#SIE.DE','#SINA','#SU.PA','#TEF.MC','#TSLA','#TWITTER','#UG.PA','#UNA.AS','#VERIZON','#VISA','#VOD.L','#VOW.DE','#VRX','#WAL_MART','#YAHOO','#YANDEX','#ZYNGA','10Y_T-NOTES','30Y_T-BOND','5Y_T-NOTES','AUDCAD`','AUDCHF`','AUDJPY`','AUDNZD`','AUDUSD`','BRENT_OIL`','CADCHF`','CADJPY`','CHFJPY`','COPPER`','CORN`','COTTON#2`','CrudeOIL`','EURAUD`','EURCAD`','EURCHF`','EURDKK`','EURGBP`','EURHUF`','EURILS`','EURJPY`','EURNOK`','EURNZD`','EURPLN`','EURSEK`','EURTRY`','EURUSD','EURUSD`','EURZAR`','GASOLINE`','GAUTRY`','GAUUSD`','GBPAUD`','GBPCAD`','GBPCHF`','GBPJPY`','GBPNZD`','GBPSGD`','GBPTRY`','GBPUSD','GBPUSD`','GOLDEUR`','GOLDTRY`','GOLD`','HEAT_OIL`','NAT_GAS`','NZDCAD`','NZDCHF`','NZDJPY`','NZDUSD`','PLATINUM`','SILVER`','SOYBEAN`','SUGAR#11','TRYBASK`','USDCAD`','USDCHF`','USDDKK`','USDHUF`','USDILS`','USDJPY','USDJPY`','USDMXN`','USDNOK`','USDPLN`','USDRUB.','USDRUB`','USDSEK`','USDSGD`','USDTRY','USDTRY`','USDZAR`','WHEAT`'};
tradePrice = {0.8200000000000002,0.4100000000000001,0.07000000000000001,2.11,1.64,0,0.13,0.9700000000000002,0.3500000000000001,0.13,1.68,0.09000000000000002,3,26,1.1,0.12,0.3700000000000001,0.11,0.18,0.13,0.15,8,4.5,0.13,0.1,0.13,0.13,0.13,35,0.13,0.16,5,0.17,0.13,7,5,0.11,0.17,0.08000000000000002,0.13,0.13,0.13,0.16,0,4,9.5,0.11,0.13,0.13,1.37,0.13,0,0.16,11,0,8,25,6,0.13,0.13,0.13,0.13,0.5400000000000001,0.13,0.13,11,0.13,2.450000000000001,0.7200000000000002,35,0.13,0.13,0.13,0.17,0.21,14,0,0.8500000000000002,25,0.8200000000000002,0.06000000000000001,0.8300000000000002,1.02,0.2700000000000001,0.18,0.11,1.3,0.13,0.14,0.13,0.13,0,1,0.3900000000000001,0.7300000000000001,0.13,0.12,0.3100000000000001,0,0.08000000000000002,0.1,0.07000000000000001,0.0007000000000000002,0.0007000000000000002,0.07000000000000002,0.0015,0.0003000000000000001,0.07000000000000001,0.0008000000000000001,0.07000000000000002,0.05000000000000001,0.006100000000000001,0.7500000000000001,0.28,0.04000000000000001,0.0007000000000000002,0.0007000000000000002,0.0004000000000000001,0.003000000000000001,0.0003000000000000001,0.7500000000000002,0.016,0.03000000000000001,0.004400000000000001,0.002,0.005000000000000001,0.005000000000000001,0.002600000000000001,0.0002,0.0002,0.025,0.002,0.2,0.02,0.0015,0.0015,0.0007000000000000002,0.05000000000000001,0.0025,0.007000000000000002,0.005000000000000001,0.0003000000000000001,0.0003000000000000001,1,4.500000000000001,0.5000000000000001,0.0024,0.008000000000000002,0.0008000000000000001,0.0008000000000000001,0.07000000000000002,0.0004000000000000001,1,0.04000000000000001,0.9500000000000002,0.09000000000000002,0.005000000000000001,0.0003000000000000001,0.0003000000000000001,0.002,0.7500000000000002,0.016,0.02,0.02,0.01,0.005000000000000001,0.004500000000000001,0.09400000000000003,0.09400000000000003,0.005000000000000001,0.0008000000000000001,0.0016,0.0016,0.02200000000000001,0.7500000000000001};
tradePrice = cell2mat(tradePrice);
hour = 4;
ListofProfits = cell(length(symbols),13);
for j = 130
    commis = tradePrice(j);
    symboltotrain = symbols(j);
    ThisCell = OpenCell{j,1};
%      if 15000 > length(ThisCell(2,:))
%          continue;
%      end
    [adftestOfSymbol,vratiotestOfSymbol,halflifeofSymbol] = StatTests(ThisCell);
    [bestnet,bestmcoofsymbol,bestsizeofsymbol,testInd,delay] = TrainTimeSeries(ThisCell,commis,hour);
    [sharpeRatio,kelly,maximumdrawdown,CashArray,dailywin,swaps] = SimulateTimeSeries(ThisCell,bestnet,bestmcoofsymbol,commis,hour,testInd,delay);
    ListofProfits{j,1} = sharpeRatio;
    ListofProfits{j,2} = bestmcoofsymbol;
    ListofProfits{j,3} = bestnet;
    ListofProfits{j,4} = bestsizeofsymbol;
    ListofProfits{j,5} = CashArray;
    ListofProfits{j,6} = symboltotrain;    
    ListofProfits{j,7} = halflifeofSymbol;
    ListofProfits{j,8} = adftestOfSymbol;
    ListofProfits{j,9} = vratiotestOfSymbol;
    ListofProfits{j,10} = maximumdrawdown;
    ListofProfits{j,11} = kelly;
    ListofProfits{j,12} = dailywin;
    ListofProfits{j,13} = swaps;
end
